{"version":3,"file":"configuration.min.js","sources":["../src/configuration.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Defines zatuk configuration script.\n *\n * @since      Moodle 2.0\n * @copyright  2023 Moodle India\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport $ from 'jquery';\nimport ModalFactory from 'core/modal_factory';\nimport Ajax from 'core/ajax';\nimport {get_string as getString} from 'core/str';\n\nconst Selectors = {\n    actions: {\n        zatuksettings: '[data-action=\"zatuksettings\"]',\n        zatukplans: '[data-action=\"zatukplans\"]',\n        zatukdetails: '[data-action=\"zatukdetails\"]',\n        updatesettings: '[data-action=\"updatesettings\"]',\n\n    },\n};\nexport const confirmbox = (message) => {\n     ModalFactory.create({\n        body: message,\n        type: ModalFactory.types.ALERT,\n        buttons: {\n            ok: getString('Thank_you'),\n        },\n        removeOnClose: true,\n      })\n      .done(function(modal) {\n        modal.show();\n      });\n};\nexport const init = () => {\n    document.addEventListener('click', function(e) {\n        let zatuksettings = e.target.closest(Selectors.actions.zatuksettings);\n        if (zatuksettings) {\n            e.preventDefault();\n            $('.section_container').addClass('d-none');\n            $('.section_container.registration_plans').removeClass('d-none');\n            $('.step-1').addClass('completed');\n            $('.step-2').addClass('active');\n        }\n    });\n    document.addEventListener('click', function(e) {\n        let zatukplans = e.target.closest(Selectors.actions.zatukplans);\n        if (zatukplans) {\n            e.preventDefault();\n            var params = {};\n            var organization = $(\"#id_organization\").val();\n            var zatuk_api_url = $(\"#id_zatuk_api_url\").val();\n            var organisationcode = $(\"#id_organization_code\").val();\n            var name = $(\"#id_name\").val();\n            var email = $(\"#id_email\").val();\n            var params = {};\n            params.organization = organization;\n            params.zatuk_api_url = zatuk_api_url;\n            params.organisationcode = organisationcode;\n            params.name = name;\n            params.email = email;\n            var promise = Ajax.call([{\n                methodname: 'repository_zatukplans',\n                args: params\n            }]);\n            promise[0].done(function(resp) {\n                if(resp.success) {\n                    var confirmA = '<div class=\"d-flex justify-content-center align-items-center';\n                    var confirmB = ' flex-column w-100 p-3 confirmationdialogue_content\">';\n                    var confirmC = '<div class=\"icon\"></div><h4 class=\"my-3\">Thank you for choosing free trail!</h4></div>';\n                    confirmbox(confirmA + confirmB + confirmC);\n                    $(\".secret_keys\").load(location.href + \" .secret_keys\");\n                    $('.section_container').addClass('d-none');\n                    $('.section_container.registration_keys').removeClass('d-none');\n                    $('.step-2').addClass('completed');\n                    $('.step-3').addClass('active');\n                } else {\n                    if(resp.errormessage === null && resp.success === null) {\n                        confirmbox(getString('serverdown', 'repository_zatuk'));\n                    } else {\n                        confirmbox(resp.errormessage);\n                    }\n                }\n            }).fail(function() {\n                confirmbox(getString('errormessage', 'repository_zatuk'));\n            });\n        }\n    });\n    document.addEventListener('click', function(e) {\n        let zatukdetails = e.target.closest(Selectors.actions.zatukdetails);\n        if (zatukdetails) {\n            e.preventDefault();\n            var params = {};\n            var promise = Ajax.call([{\n                methodname: 'repository_enable_zatuk',\n                args: params\n            }]);\n            promise[0].done(function() {\n                location.reload();\n            }).fail(function() {\n                confirmbox('exception');\n            });\n        }\n    });\n    document.addEventListener('click', function(e) {\n        let updatesettings = e.target.closest(Selectors.actions.updatesettings);\n        if (updatesettings) {\n            e.preventDefault();\n            var params = {};\n            var organization = $(\"#id_organization\").val();\n            var name = $(\"#id_name\").val();\n            var email = $(\"#id_email\").val();\n            var params = {};\n            params.organization = organization;\n            params.name = name;\n            params.email = email;\n            var promise = Ajax.call([{\n                methodname: 'repository_updatezatuksettings',\n                args: params\n            }]);\n            promise[0].done(function(resp) {\n                if(resp) {\n                    var confirmA = '<div class=\"d-flex justify-content-center align-items-center';\n                    var confirmB = ' flex-column w-100 p-3 confirmationdialogue_content\">';\n                    var confirmC = '<div class=\"icon\"></div><h4 class=\"my-3\">Updated successfully</h4></div>';\n                    confirmbox(confirmA + confirmB + confirmC);\n                }\n            }).fail(function() {\n                confirmbox('exception');\n            });\n        }\n    });\n};\n\n\n"],"names":["Selectors","zatuksettings","zatukplans","zatukdetails","updatesettings","confirmbox","message","create","body","type","ModalFactory","types","ALERT","buttons","ok","removeOnClose","done","modal","show","document","addEventListener","e","target","closest","preventDefault","addClass","removeClass","params","organization","val","zatuk_api_url","organisationcode","name","email","Ajax","call","methodname","args","resp","success","confirmA","load","location","href","errormessage","fail","reload"],"mappings":";;;;;;;8OA2BMA,kBACO,CACLC,cAAe,gCACfC,WAAY,6BACZC,aAAc,+BACdC,eAAgB,kCAIXC,WAAcC,iCACTC,OAAO,CACjBC,KAAMF,QACNG,KAAMC,uBAAaC,MAAMC,MACzBC,QAAS,CACLC,IAAI,mBAAU,cAElBC,eAAe,IAEhBC,MAAK,SAASC,OACbA,MAAMC,wDAGM,KAChBC,SAASC,iBAAiB,SAAS,SAASC,GACpBA,EAAEC,OAAOC,QAAQvB,kBAAkBC,iBAEnDoB,EAAEG,qCACA,sBAAsBC,SAAS,8BAC/B,yCAAyCC,YAAY,8BACrD,WAAWD,SAAS,iCACpB,WAAWA,SAAS,cAG9BN,SAASC,iBAAiB,SAAS,SAASC,MACvBA,EAAEC,OAAOC,QAAQvB,kBAAkBE,YACpC,CACZmB,EAAEG,qBACEG,OAAS,GACTC,cAAe,mBAAE,oBAAoBC,MACrCC,eAAgB,mBAAE,qBAAqBD,MACvCE,kBAAmB,mBAAE,yBAAyBF,MAC9CG,MAAO,mBAAE,YAAYH,MACrBI,OAAQ,mBAAE,aAAaJ,OACvBF,OAAS,IACNC,aAAeA,aACtBD,OAAOG,cAAgBA,cACvBH,OAAOI,iBAAmBA,iBAC1BJ,OAAOK,KAAOA,KACdL,OAAOM,MAAQA,MACDC,cAAKC,KAAK,CAAC,CACrBC,WAAY,wBACZC,KAAMV,UAEF,GAAGX,MAAK,SAASsB,SAClBA,KAAKC,QAAS,CAIblC,WAAWmC,+NACT,gBAAgBC,KAAKC,SAASC,KAAO,qCACrC,sBAAsBlB,SAAS,8BAC/B,wCAAwCC,YAAY,8BACpD,WAAWD,SAAS,iCACpB,WAAWA,SAAS,eAEG,OAAtBa,KAAKM,cAA0C,OAAjBN,KAAKC,QAClClC,YAAW,mBAAU,aAAc,qBAEnCA,WAAWiC,KAAKM,iBAGzBC,MAAK,WACJxC,YAAW,mBAAU,eAAgB,4BAIjDc,SAASC,iBAAiB,SAAS,SAASC,MACrBA,EAAEC,OAAOC,QAAQvB,kBAAkBG,cACpC,CACdkB,EAAEG,iBAEYU,cAAKC,KAAK,CAAC,CACrBC,WAAY,0BACZC,KAHS,MAKL,GAAGrB,MAAK,WACZ0B,SAASI,YACVD,MAAK,WACJxC,WAAW,oBAIvBc,SAASC,iBAAiB,SAAS,SAASC,MACnBA,EAAEC,OAAOC,QAAQvB,kBAAkBI,gBACpC,CAChBiB,EAAEG,qBACEG,OAAS,GACTC,cAAe,mBAAE,oBAAoBC,MACrCG,MAAO,mBAAE,YAAYH,MACrBI,OAAQ,mBAAE,aAAaJ,OACvBF,OAAS,IACNC,aAAeA,aACtBD,OAAOK,KAAOA,KACdL,OAAOM,MAAQA,MACDC,cAAKC,KAAK,CAAC,CACrBC,WAAY,iCACZC,KAAMV,UAEF,GAAGX,MAAK,SAASsB,SAClBA,KAAM,CAILjC,WAAWmC,iMAEhBK,MAAK,WACJxC,WAAW"}