define("repository_zatuk/configuration",["exports","jquery","core/ajax","core/str","repository_zatuk/messagemodal"],(function(_exports,_jquery,_ajax,_str,_messagemodal){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Defines zatuk configuration script.
   *
   * @since      Moodle 2.0
   * @copyright  2023 Moodle India
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=_interopRequireDefault(_jquery),_ajax=_interopRequireDefault(_ajax),_messagemodal=_interopRequireDefault(_messagemodal);const Selectors_actions={zatuksettings:'[data-action="zatuksettings"]',zatukplans:'[data-action="zatukplans"]',zatukdetails:'[data-action="zatukdetails"]',updatesettings:'[data-action="updatesettings"]'};let MessageModal=new _messagemodal.default;_exports.init=()=>{document.addEventListener("click",(function(e){e.target.closest(Selectors_actions.zatuksettings)&&(e.preventDefault(),(0,_jquery.default)(".section_container").addClass("d-none"),(0,_jquery.default)(".section_container.registration_plans").removeClass("d-none"),(0,_jquery.default)(".step-1").addClass("completed"),(0,_jquery.default)(".step-2").addClass("active"))})),document.addEventListener("click",(function(e){if(e.target.closest(Selectors_actions.zatukplans)){e.preventDefault();var params={},organization=(0,_jquery.default)("#id_organization").val(),zatuk_api_url=(0,_jquery.default)("#id_zatuk_api_url").val(),organisationcode=(0,_jquery.default)("#id_organization_code").val(),name=(0,_jquery.default)("#id_name").val(),email=(0,_jquery.default)("#id_email").val();(params={}).organization=organization,params.zatuk_api_url=zatuk_api_url,params.organisationcode=organisationcode,params.name=name,params.email=email,_ajax.default.call([{methodname:"repository_zatukplans",args:params}])[0].done((function(resp){if(resp.success){var params={value:null};_ajax.default.call([{methodname:"repository_enable_zatuk",args:params}])[0].done((function(){(0,_str.get_string)("freetrailmessage","repository_zatuk").then((str=>{MessageModal.confirmbox((0,_str.get_string)("finaltrailmessage","repository_zatuk",str))})),(0,_jquery.default)(".secret_keys").load(location.href+" .secret_keys"),(0,_jquery.default)(".section_container").addClass("d-none"),(0,_jquery.default)(".section_container.registration_keys").removeClass("d-none"),(0,_jquery.default)(".step-2").addClass("completed"),(0,_jquery.default)(".step-3").addClass("active")})).fail((function(){MessageModal.confirmbox((0,_str.get_string)("exception"))}))}else null===resp.errormessage&&null===resp.success?MessageModal.confirmbox((0,_str.get_string)("serverdown","repository_zatuk")):MessageModal.confirmbox(resp.errormessage)})).fail((function(){MessageModal.confirmbox((0,_str.get_string)("errormessage","repository_zatuk"))}))}})),document.addEventListener("click",(function(e){e.target.closest(Selectors_actions.zatukdetails)&&(e.preventDefault(),location.reload())})),document.addEventListener("click",(function(e){if(e.target.closest(Selectors_actions.updatesettings)){e.preventDefault();var params={},organization=(0,_jquery.default)("#id_organization").val(),name=(0,_jquery.default)("#id_name").val(),email=(0,_jquery.default)("#id_email").val();(params={}).organization=organization,params.name=name,params.email=email,_ajax.default.call([{methodname:"repository_updatezatuksettings",args:params}])[0].done((function(resp){resp&&(0,_str.get_string)("updatemessage","repository_zatuk").then((str=>{MessageModal.confirmbox((0,_str.get_string)("finaltrailmessage","repository_zatuk",str))}))})).fail((function(){MessageModal.confirmbox("exception")}))}}))}}));

//# sourceMappingURL=configuration.min.js.map